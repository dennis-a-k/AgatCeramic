document.addEventListener("DOMContentLoaded",function(){const d=document.querySelectorAll(".fullscreen-section"),a=document.querySelectorAll(".nav-dot"),r=document.getElementById("mainHeader"),f={threshold:.1},u=new IntersectionObserver(function(t){t.forEach(e=>{if(e.isIntersecting){const s=e.target.querySelector(".section-content");s&&s.classList.add("visible"),e.target.querySelectorAll(".btn").forEach(c=>{c.classList.contains("visible")||c.classList.add("visible")});const o=e.target.querySelector(".section-bg");o&&!o.classList.contains("zoomed")&&o.classList.add("zoomed"),e.target.querySelectorAll(".benefit-card, .contact-form").forEach(c=>{c.classList.contains("visible")||c.classList.add("visible")});const v=e.target.id;a.forEach(c=>{c.classList.toggle("active",c.dataset.section===v)})}})},f);d.forEach(t=>{u.observe(t)}),a.forEach(t=>{t.addEventListener("click",function(){const e=this.dataset.section,s=document.getElementById(e);s&&window.scrollTo({top:s.offsetTop,behavior:"smooth"})})}),window.addEventListener("scroll",function(){window.scrollY>50?r.classList.add("scrolled"):r.classList.remove("scrolled")});const m=document.getElementById("partnerForm"),i=document.getElementById("successModal"),b=document.querySelector(".close-modal");m.addEventListener("submit",async function(t){t.preventDefault();const e=document.getElementById("loader");e.style.display="flex";try{const s=new FormData(this),o=await(await fetch("/partnerships-call",{method:"POST",body:s,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"}})).json();o.success?(i.classList.add("show"),this.reset(),window.scrollTo({top:0,behavior:"smooth"})):alert("Ошибка при отправке формы: "+(o.message||"Попробуйте снова"))}catch(s){console.error("Ошибка:",s),alert("Сетевая ошибка. Проверьте соединение.")}finally{e.style.display="none"}}),b.addEventListener("click",function(){i.classList.remove("show")}),window.addEventListener("click",function(t){t.target===i&&i.classList.remove("show")});const n=document.querySelector(".fullscreen-section");if(n){const t=n.querySelector(".section-content");t&&t.classList.add("visible");const e=n.querySelector(".section-bg");e&&e.classList.add("zoomed"),n.querySelectorAll(".btn").forEach(o=>o.classList.add("visible")),n.querySelectorAll(".benefit-card, .contact-form").forEach(o=>o.classList.add("visible"))}});
