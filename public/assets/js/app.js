(function(e){e(window);var o=e("body");e("[data-bg-image]").each(function(){var i=e(this),s=i.data("bg-image");i.css("background-image","url("+s+")")}),e("[data-bg-banner]").each(function(){var i=e(this),s=i.data("bg-banner");i.css("background","linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5)), url("+s+")"),i.css("background-repeat","no-repeat"),i.css("background-size","100% auto"),i.css("background-position","center")}),e(window).on("scroll",function(i){var s=e(window).scrollTop()+1;s>250?e(".sticky-nav").addClass("menu_fixed animated fadeInDown"):e(".sticky-nav").removeClass("menu_fixed animated fadeInDown")}),e(".dropdown").on("show.bs.dropdown",function(){e(this).find(".dropdown-menu").first().stop(!0,!0).slideDown()}),e(".dropdown").on("hide.bs.dropdown",function(){e(this).find(".dropdown-menu").first().stop(!0,!0).slideUp()}),function(){var i=e(".offcanvas-toggle"),s=e(".offcanvas"),l=e(".offcanvas-overlay"),c=e(".mobile-menu-toggle");i.on("click",function(d){d.preventDefault();var u=e(this),m=u.attr("href");o.addClass("offcanvas-open"),e(m).addClass("offcanvas-open"),l.fadeIn(),u.parent().hasClass("mobile-menu-toggle")&&u.addClass("close")}),e(".offcanvas-close, .offcanvas-overlay").on("click",function(d){d.preventDefault(),o.removeClass("offcanvas-open"),s.removeClass("offcanvas-open"),l.fadeOut(),c.find("a").removeClass("close")})}();function t(){var i=e(".offcanvas-menu, .overlay-menu"),s=i.find(".sub-menu");s.parent().prepend('<span class="menu-expand"></span>'),i.on("click","li a, .menu-expand",function(l){var c=e(this);(c.attr("href")==="#"||c.hasClass("menu-expand"))&&(l.preventDefault(),c.siblings("ul:visible").length?(c.parent("li").removeClass("active"),c.siblings("ul").slideUp(),c.parent("li").find("li").removeClass("active"),c.parent("li").find("ul:visible").slideUp()):(c.parent("li").addClass("active"),c.closest("li").siblings("li").removeClass("active").find("li").removeClass("active"),c.closest("li").siblings("li").find("ul:visible").slideUp(),c.siblings("ul").slideDown()))})}t(),new Swiper(".hero-slider.swiper-container",{loop:!0,speed:2e3,effect:"fade",autoplay:{delay:7e3,disableOnInteraction:!1},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),new Swiper(".tab-slider.swiper-container",{loop:!0,slidesPerView:6,spaceBetween:30,speed:1500,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:2},478:{slidesPerView:2},576:{slidesPerView:3},768:{slidesPerView:4},992:{slidesPerView:5},1200:{slidesPerView:6}}}),new Swiper(".content-top",{slidesPerView:2,spaceBetween:30,speed:1500,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:1},478:{slidesPerView:1},576:{slidesPerView:1},768:{slidesPerView:2},992:{slidesPerView:2},1200:{slidesPerView:2}}}),new Swiper(".feature-product-slider.swiper-container",{slidesPerView:2,spaceBetween:30,speed:1500,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:1},478:{slidesPerView:1},576:{slidesPerView:1},768:{slidesPerView:1},992:{slidesPerView:2},1200:{slidesPerView:2}}}),new Swiper(".new-product-slider.swiper-container",{slidesPerView:4,spaceBetween:30,speed:1500,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:1},478:{slidesPerView:1},576:{slidesPerView:2},768:{slidesPerView:2},992:{slidesPerView:3},1200:{slidesPerView:4}}});var n=new Swiper(".gallery-thumbs",{spaceBetween:10,slidesPerView:3,freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0,centerMood:!0});new Swiper(".gallery-top",{spaceBetween:0,loop:!0,slidesPerView:1,centerMood:!0,thumbs:{swiper:n}});var r=new Swiper(".zoom-thumbs",{spaceBetween:18,slidesPerView:3,freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});new Swiper(".zoom-top",{spaceBetween:0,slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},thumbs:{swiper:r}});var r=new Swiper(".zoom-thumbs-2",{spaceBetween:20,slidesPerView:5,direction:"vertical",freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0});new Swiper(".zoom-top-2",{spaceBetween:0,loop:!0,thumbs:{swiper:r}});var n=new Swiper(".gallery-thumbs",{spaceBetween:10,slidesPerView:3,freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});new Swiper(".gallery-top",{spaceBetween:0,loop:!0,thumbs:{swiper:n}});var a=e(".cart-plus-minus");a.prepend('<div class="dec qtybutton">-</div>'),a.append('<div class="inc qtybutton">+</div>'),e(".qtybutton").on("click",function(){var i=e(this),s=i.parent().find("input").val();if(i.text()==="+")var l=parseFloat(s)+1;else if(s>1)var l=parseFloat(s)-1;else l=1;i.parent().find("input").val(l)}),new Swiper(".single-product-slider",{slidesPerView:4,spaceBetween:20,speed:1500,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:1},478:{slidesPerView:1},576:{slidesPerView:2},768:{slidesPerView:3},992:{slidesPerView:3},1024:{slidesPerView:4},1200:{slidesPerView:4}}}),e(".checkout-toggle2").on("click",function(){e(".open-toggle2").slideToggle(1e3)}),e(".checkout-toggle").on("click",function(){e(".open-toggle").slideToggle(1e3)}),e.scrollUp({scrollText:'<i class="pe-7s-angle-up"></i>',easingType:"linear",scrollSpeed:900,animation:"fade"}),e("[data-countdown]").each(function(){var i=e(this),s=e(this).data("countdown");i.countdown(s,function(l){i.html(l.strftime('<span class="cdown hour"><span class="cdown-1">%-H</span><p>Hrs</p></span> <span class="cdown minutes"><span class="cdown-1">%M</span> <p>Min</p></span> <span class="cdown second"><span class="cdown-1"> %S</span> <p>Sec</p></span>'))})}),new Swiper(".blog-post-media.swiper-container",{slidesPerView:1,spaceBetween:0,loop:!0,autoplay:{delay:2e3,disableOnInteraction:!1},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),new Swiper(".brand-slider.swiper-container",{slidesPerView:4,speed:1500,loop:!0,autoplay:{delay:2e3,disableOnInteraction:!1},breakpoints:{0:{slidesPerView:1},480:{slidesPerView:2},768:{slidesPerView:2},992:{slidesPerView:3},1200:{slidesPerView:4}}}),e(".venobox").venobox()})(jQuery);document.addEventListener("DOMContentLoaded",function(){C(),q(),E()});function C(){document.querySelectorAll(".add-cart").forEach(r=>{r.addEventListener("click",function(){var s;const n=this.dataset.productId,a=(s=this.closest(".pro-details-quality"))==null?void 0:s.querySelector(".cart-plus-minus-box"),i=a?parseInt(a.value):1;a&&(a.value=1),x(n,i)})}),document.querySelectorAll(".cart-plus-minus-box").forEach(r=>{r.closest(".table-content")&&r.addEventListener("change",function(){const n=this.closest("tr").dataset.productId;v(n,this.value)})}),document.querySelectorAll(".product-remove a").forEach(r=>{r.addEventListener("click",function(n){n.preventDefault();const a=this.closest("tr").dataset.productId;b(a)})})}function q(){document.querySelectorAll(".cart-plus-minus").forEach(o=>{const t=o.querySelector(".cart-plus-minus-box");if(!t)return;const r=document.createElement("div"),n=document.createElement("div");r.className="dec qtybutton",r.textContent="-",n.className="inc qtybutton",n.textContent="+",t.parentNode.insertBefore(r,t),t.parentNode.appendChild(n),r.addEventListener("click",()=>w(t,-1)),n.addEventListener("click",()=>w(t,1))})}function w(e,o){let t=parseInt(e.value);if(t=Math.max(1,t+o),e.value=t,e.closest(".table-content")){const r=e.closest("tr").dataset.productId;v(r,t)}}function x(e,o){fetch("/cart/add",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({product_id:e,quantity:o})}).then(t=>t.json()).then(t=>{h(t.message),y(t.cart_count),f()}).catch(t=>console.error("Ошибка:",t))}function v(e,o){fetch("/cart/update",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({product_id:e,quantity:o})}).then(t=>t.json()).then(t=>{g(t.total),V(e,o),f()}).catch(t=>console.error("Ошибка:",t))}function b(e){fetch("/cart/remove",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({product_id:e})}).then(o=>o.json()).then(o=>{const t=document.querySelector(`tr[data-product-id="${e}"]`);t&&t.remove(),g(o.total),y(o.cart_count),h(o.message),f(),window.location.pathname==="/cart"&&o.cart_count===0&&window.location.reload()}).catch(o=>console.error("Ошибка:",o))}function h(e){const o=document.createElement("div");o.className="cart-notification",o.textContent=e,document.body.appendChild(o),setTimeout(()=>{o.remove()},3e3)}function y(e){const o=document.querySelector(".header-action-num"),t=document.querySelectorAll(".header-action-btn-cart div, .header-action-btn-cart");o&&(o.textContent=e),t.forEach(r=>{let n=r.querySelector(".header-action-num");if(e>0){if(!n)if(n=document.createElement("span"),n.className="header-action-num",r.tagName.toLowerCase()==="a"){const a=r.querySelector(".pe-7s-cart");a&&a.after(n)}else r.appendChild(n);n.textContent=e.toString()}else n&&n.remove()})}function g(e){let o=e.toLocaleString("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(",",".");const t=document.querySelector(".cart-total");t&&(t.textContent=`${o} ₽`)}function V(e,o){const t=document.querySelector(`tr[data-product-id="${e}"]`);if(t){const r=t.querySelector(".product-subtotal"),a=t.querySelector(".product-price-cart .amount").textContent.replace(/\s/g,""),i=parseFloat(a);if(r&&!isNaN(i)){let s=i*o;s=s.toLocaleString("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(",","."),r.textContent=`${s} ₽`}}}function E(){const e=document.querySelector('a[href="#offcanvas-cart"]');e&&e.addEventListener("click",function(o){f()}),S()}function f(){fetch("/cart/offcanvas",{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.text()).then(e=>{const r=new DOMParser().parseFromString(e,"text/html").querySelector("#offcanvas-cart");if(r){const n=document.querySelector("#offcanvas-cart");n.innerHTML=r.innerHTML,S()}}).catch(e=>{console.error("Ошибка обновления корзины:",e)})}function S(){document.querySelectorAll("#offcanvas-cart .remove").forEach(t=>{t.replaceWith(t.cloneNode(!0));const r=document.querySelector(`#offcanvas-cart .remove[data-product-id="${t.dataset.productId}"]`);r&&r.addEventListener("click",function(n){n.preventDefault();const a=this.dataset.productId;b(a)})});const o=document.querySelector("#offcanvas-cart .offcanvas-close");o&&(o.replaceWith(o.cloneNode(!0)),document.querySelector("#offcanvas-cart .offcanvas-close").addEventListener("click",function(r){r.preventDefault(),document.body.classList.remove("offcanvas-open"),document.querySelector("#offcanvas-cart").classList.remove("offcanvas-open"),document.querySelector(".offcanvas-overlay").style.display="none",document.querySelector(".offcanvas-overlay").classList.remove("active")}))}document.addEventListener("DOMContentLoaded",function(){const e=window.location.origin;document.querySelectorAll(".quickview").forEach(t=>{t.addEventListener("click",function(){document.querySelector(".cart-plus-minus-box").value=1;const r=this.getAttribute("data-id");document.querySelector("#modalProduct .modal-body h2").innerText="Загрузка...",document.querySelector("#modalProduct .modal-body .new-price").innerText="",document.querySelector("#modalProduct .modal-body .swiper-container .swiper-wrapper").innerHTML="",fetch(`${e}/api/product/${r}`).then(n=>{if(!n.ok)throw new Error("Ошибка загрузки данных");return n.json()}).then(n=>{const a=n.category.subtitle+" "+n.title||"---",s=(+n.price||"---").toLocaleString("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(",","."),l=n.sku||"---",c=n.unit==="шт"?"<span>шт.</span>":"<span>м<sup>2</sup></span>",d=n.collection?n.collection.title:"---",u=n.brand?n.brand.title:"---",m=n.images&&n.images.length>0?n.images:[{title:null}],P=document.querySelector("#modalProduct .pro-details-cart .add-cart");document.querySelector("#modalProduct .modal-body h2").innerText=a,document.querySelector("#modalProduct .modal-body .new-price").innerText=`${s} ₽`,document.querySelector("#modalProduct .modal-body .new-sku").innerText=l,document.querySelector("#modalProduct .modal-body .new-unit").innerHTML=c,document.querySelector("#modalProduct .modal-body .new-collection").innerText=d,document.querySelector("#modalProduct .modal-body .new-brand").innerText=u,P.setAttribute("data-product-id",n.id),document.querySelector("#modalProduct .modal-body .swiper-container .swiper-wrapper").innerHTML=m.map(p=>`<div class="swiper-slide" style="border: none;"><img class="img-responsive m-auto" src="${p.title?`${e}/storage/images/${p.title}`:`${e}/assets/images/stock/stock-image.png`}" alt="${p.title?p.title:"Изображение по умолчанию"}"></div>`).join("")}).catch(n=>{console.error(n),document.querySelector("#modalProduct .modal-body h2").innerText="Ошибка загрузки данных"})})})});
